<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flappy Bird</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { display: flex; justify-content: center; align-items: center; height: 100vh; background: #70c5ce; }
  canvas { border: 2px solid #000; background: url('https://i.postimg.cc/KjNjLv9J/bg.png'); background-size: cover; }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const birdImgs = [];
let birdFrame = 0;
birdImgs[0] = new Image();
birdImgs[0].src = "https://i.postimg.cc/jSGxD7xR/bird1.png";
birdImgs[1] = new Image();
birdImgs[1].src = "https://i.postimg.cc/J0nV6rrT/bird2.png";
birdImgs[2] = new Image();
birdImgs[2].src = "https://i.postimg.cc/44MSkbB4/bird3.png";

const ground = new Image();
ground.src = "https://i.postimg.cc/bY7fHhXR/ground.png";

const pipe = new Image();
pipe.src = "https://i.postimg.cc/DzPwRzhF/pipe.png";

const restartImg = new Image();
restartImg.src = "https://i.postimg.cc/3RhnJnzm/restart.png";

let bird = {
  x: 50,
  y: 200,
  width: 34,
  height: 24,
  gravity: 0.6,
  lift: -10,
  velocity: 0
};

let pipes = [];
let frame = 0;
let score = 0;
let gameOver = false;

document.addEventListener("keydown", () => {
  bird.velocity = bird.lift;
});

function resetGame() {
  bird.y = 200;
  bird.velocity = 0;
  pipes = [];
  score = 0;
  gameOver = false;
  loop();
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // Draw pipes
  for (let i = 0; i < pipes.length; i++) {
    let p = pipes[i];
    ctx.drawImage(pipe, p.x, 0, 52, p.top);
    ctx.drawImage(pipe, p.x, canvas.height - p.bottom, 52, p.bottom);
    
    p.x -= 2;

    // Check collision
    if (bird.x < p.x + 52 && bird.x + bird.width > p.x &&
        (bird.y < p.top || bird.y + bird.height > canvas.height - p.bottom)) {
      gameOver = true;
    }

    // Increase score
    if (!p.passed && p.x + 52 < bird.x) {
      score++;
      p.passed = true;
    }
  }

  // Remove offscreen pipes
  pipes = pipes.filter(p => p.x + 52 > 0);

  // Draw ground
  ctx.drawImage(ground, 0, canvas.height - 112, canvas.width, 112);

  // Draw bird
  ctx.drawImage(birdImgs[birdFrame], bird.x, bird.y, bird.width, bird.height);

  // Animate bird wings
  if (frame % 5 === 0) birdFrame = (birdFrame + 1) % birdImgs.length;

  // Bird physics
  bird.velocity += bird.gravity;
  bird.y += bird.velocity;

  // Hit ground
  if (bird.y + bird.height > canvas.height - 112) {
    bird.y = canvas.height - 112 - bird.height;
    gameOver = true;
  }

  // Draw score
  ctx.fillStyle = "#fff";
  ctx.font = "30px Arial";
  ctx.fillText(score, canvas.width / 2 - 10, 50);
}

function loop() {
  frame++;

  if (frame % 100 === 0) {
    let topPipeHeight = Math.floor(Math.random() * 200) + 50;
    let bottomPipeHeight = canvas.height - topPipeHeight - 150;
    pipes.push({ x: canvas.width, top: topPipeHeight, bottom: bottomPipeHeight, passed: false });
  }

  draw();

  if (gameOver) {
    ctx.drawImage(restartImg, canvas.width / 2 - 50, canvas.height / 2 - 50, 100, 100);
    canvas.addEventListener("click", handleRestart, { once: true });
  } else {
    requestAnimationFrame(loop);
  }
}

function handleRestart() {
  resetGame();
}

loop();
</script>
</body>
</html>
